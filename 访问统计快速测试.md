# è®¿é—®ç»Ÿè®¡å¿«é€Ÿæµ‹è¯•æŒ‡å—

## ğŸš€ å¿«é€Ÿæµ‹è¯•æ­¥éª¤

### æ–¹æ³• 1: æµè§ˆå™¨æµ‹è¯•ï¼ˆæ¨èï¼‰

1. **æ‰“å¼€ç½‘ç«™**
2. **æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰**
3. **æ¸…é™¤ sessionStorage**ï¼š
   ```javascript
   sessionStorage.removeItem('rabbit_visit_recorded');
   sessionStorage.removeItem('rabbit_session_id');
   console.log('âœ… SessionStorage cleared');
   ```
4. **åˆ·æ–°é¡µé¢**
5. **æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—**ï¼Œåº”è¯¥çœ‹åˆ°ï¼š
   ```
   [App] Starting to record page visit...
   [App] Recording page visit now...
   [App] ğŸ“¤ Sending visit record to: ...
   [App] ğŸ“¥ Response received: ...
   [App] âœ… Page visit recorded successfully: ...
   ```

### æ–¹æ³• 2: ç›´æ¥æµ‹è¯• APIï¼ˆcurlï¼‰

```bash
# æ›¿æ¢ä¸ºä½ çš„åç«¯åœ°å€
curl -X POST https://your-backend-url/api/analytics/visit \
  -H "Content-Type: application/json" \
  -H "CF-Connecting-IP: 8.8.8.8" \
  -d '{
    "pagePath": "/test",
    "walletAddress": null,
    "referrer": null,
    "language": "zh",
    "isMobile": false,
    "sessionId": "test_'$(date +%s)'"
  }'
```

**é¢„æœŸå“åº”ï¼š**
```json
{
  "ok": true,
  "message": "Visit recorded"
}
```

### æ–¹æ³• 3: æ£€æŸ¥æ•°æ®åº“

åœ¨ Supabase SQL Editor æ‰§è¡Œï¼š
```sql
-- æŸ¥çœ‹æœ€æ–°è®°å½•
SELECT * FROM page_visits ORDER BY created_at DESC LIMIT 5;

-- æŸ¥çœ‹è®°å½•æ•°é‡
SELECT COUNT(*) FROM page_visits;
```

## ğŸ” é—®é¢˜è¯Šæ–­

### å¦‚æœå‰ç«¯æ²¡æœ‰å‘é€è¯·æ±‚

**æ£€æŸ¥ï¼š**
1. æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ï¼Ÿ
2. sessionStorage æ˜¯å¦å·²æ¸…é™¤ï¼Ÿ
3. é¡µé¢æ˜¯å¦å®Œå…¨åŠ è½½ï¼Ÿ

**è§£å†³ï¼š**
```javascript
// åœ¨æ§åˆ¶å°æ‰§è¡Œ
sessionStorage.clear();
location.reload();
```

### å¦‚æœåç«¯æ²¡æœ‰æ”¶åˆ°è¯·æ±‚

**æ£€æŸ¥ï¼š**
1. åç«¯æœåŠ¡æ˜¯å¦è¿è¡Œï¼Ÿ
2. API è·¯ç”±æ˜¯å¦æ­£ç¡®æ³¨å†Œï¼Ÿ
3. CORS é…ç½®æ˜¯å¦æ­£ç¡®ï¼Ÿ

**æŸ¥çœ‹åç«¯æ—¥å¿—ï¼š**
- åº”è¯¥çœ‹åˆ° `[Analytics API] Client IP: ...`
- åº”è¯¥çœ‹åˆ° `[Analytics API] Recording visit: ...`

### å¦‚æœæ•°æ®åº“æ’å…¥å¤±è´¥

**æ£€æŸ¥åç«¯æ—¥å¿—ï¼š**
- æŸ¥æ‰¾ `[Analytics] âŒ Failed to insert page visit:`
- æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯

**å¸¸è§é”™è¯¯ï¼š**
- `permission denied` â†’ æ£€æŸ¥ Supabase æœåŠ¡è§’è‰²å¯†é’¥
- `column does not exist` â†’ æ£€æŸ¥è¡¨ç»“æ„
- `null value in column` â†’ æ£€æŸ¥å¿…å¡«å­—æ®µ

## ğŸ“ æ—¥å¿—ä½ç½®

### å‰ç«¯æ—¥å¿—ï¼ˆæµè§ˆå™¨æ§åˆ¶å°ï¼‰
- `[App] Starting to record page visit...`
- `[App] ğŸ“¤ Sending visit record to: ...`
- `[App] ğŸ“¥ Response received: ...`
- `[App] âœ… Page visit recorded successfully: ...`

### åç«¯æ—¥å¿—ï¼ˆæœåŠ¡å™¨ï¼‰
- `[Analytics API] Client IP: ...`
- `[Analytics API] Rate limit check: ...`
- `[Analytics API] Recording visit: ...`
- `[Analytics] Inserting page visit: ...`
- `[Analytics] âœ… Page visit inserted successfully: ...`

## âœ… æˆåŠŸæ ‡å¿—

1. âœ… å‰ç«¯æ§åˆ¶å°æ˜¾ç¤º `âœ… Page visit recorded successfully`
2. âœ… åç«¯æ—¥å¿—æ˜¾ç¤º `âœ… Page visit inserted successfully`
3. âœ… æ•°æ®åº“æŸ¥è¯¢æœ‰è®°å½•
4. âœ… ç®¡ç†åå°æ˜¾ç¤ºæ•°æ®

